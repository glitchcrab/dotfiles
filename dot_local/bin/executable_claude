#!/usr/bin/env bash

# get the current directory
CURRENT_DIR_PATH="${PWD##}"
CURRENT_DIR_NAME="${PWD##*/}"
BASE_DIR="/home/shw/temp/bubblewrap"

bwrap \
     --ro-bind /usr /usr \
     --ro-bind /lib /lib \
     --ro-bind /lib64 /lib64 \
     --ro-bind /bin /bin \
     --ro-bind /etc/resolv.conf /etc/resolv.conf \
     --ro-bind /etc/hosts /etc/hosts \
     --ro-bind /etc/ssl /etc/ssl \
     --ro-bind /etc/passwd /etc/passwd \
     --ro-bind /etc/group /etc/group \
     --ro-bind /opt/claude-code /opt/claude-code \
     --bind "${CURRENT_DIR_PATH}" "${BASE_DIR}/${CURRENT_DIR_NAME}" \
     --bind "${HOME}/.claude" "${HOME}/.claude" \
     --bind "${HOME}/.claude.json" "${HOME}/.claude.json" \
     --bind "/home/shw/.vscode/" "/home/shw/.vscode/" \
     --tmpfs /tmp \
     --proc /proc \
     --dev /dev \
     --share-net \
     --unshare-pid \
     --die-with-parent \
     --chdir "${BASE_DIR}/${CURRENT_DIR_NAME}" \
     /usr/bin/claude "$@"

